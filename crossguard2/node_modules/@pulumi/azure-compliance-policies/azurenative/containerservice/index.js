"use strict";
// Copyright 2016-2024, Pulumi Corporation.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//
// ------------------------------- WARNING -------------------------------------
// This file was programmatically generated. Do not edit unless you know what
// you're doing.
// ------------------------------- WARNING -------------------------------------
Object.defineProperty(exports, "__esModule", { value: true });
exports.v20240902preview = exports.v20240702preview = exports.v20240602preview = exports.v20240502preview = exports.v20240402preview = exports.v20240302preview = exports.v20240202preview = exports.v20240102preview = exports.v20231102preview = exports.v20231002preview = exports.v20230902preview = exports.v20230815preview = exports.v20230802preview = exports.v20230702preview = exports.v20230615preview = exports.v20230602preview = exports.v20230502preview = exports.v20230315preview = exports.v20220702preview = exports.v20220402preview = exports.v20191027preview = exports.ManagedCluster = void 0;
const policy_1 = require("@pulumi/policy");
const compliance_policy_manager_1 = require("@pulumi/compliance-policy-manager");
const managedCluster_1 = require("@pulumi/azure-native/containerservice/managedCluster");
var ManagedCluster;
(function (ManagedCluster) {
    /**
     * Checks AKS cluster has Network Policy configured.
     *
     * @severity high
     * @frameworks iso27001, pcidss
     * @topics kubernetes, network
     * @link https://kubernetes.io/docs/concepts/services-networking/network-policies
     */
    ManagedCluster.configureNetworkPolicy = compliance_policy_manager_1.policyManager.registerPolicy({
        resourceValidationPolicy: {
            name: "azurenative-containerservice-managedcluster-configure-network-policy",
            description: "Checks AKS cluster has Network Policy configured.",
            configSchema: compliance_policy_manager_1.policyManager.policyConfigSchema,
            enforcementLevel: "advisory",
            validateResource: (0, policy_1.validateResourceOfType)(managedCluster_1.ManagedCluster, (mangagedCluster, args, reportViolation) => {
                if (!compliance_policy_manager_1.policyManager.shouldEvalPolicy(args)) {
                    return;
                }
                if (mangagedCluster.networkProfile) {
                    if (!mangagedCluster.networkProfile.networkPolicy) {
                        reportViolation("Ensure AKS cluster has Network Policy configured.");
                    }
                }
            }),
        },
        vendors: ["azure"],
        services: ["containerservice"],
        severity: "high",
        topics: ["network", "kubernetes"],
        frameworks: ["pcidss", "iso27001"],
    });
})(ManagedCluster || (ManagedCluster = {}));
exports.ManagedCluster = ManagedCluster;
exports.v20191027preview = require("./v20191027preview");
exports.v20220402preview = require("./v20220402preview");
exports.v20220702preview = require("./v20220702preview");
exports.v20230315preview = require("./v20230315preview");
exports.v20230502preview = require("./v20230502preview");
exports.v20230602preview = require("./v20230602preview");
exports.v20230615preview = require("./v20230615preview");
exports.v20230702preview = require("./v20230702preview");
exports.v20230802preview = require("./v20230802preview");
exports.v20230815preview = require("./v20230815preview");
exports.v20230902preview = require("./v20230902preview");
exports.v20231002preview = require("./v20231002preview");
exports.v20231102preview = require("./v20231102preview");
exports.v20240102preview = require("./v20240102preview");
exports.v20240202preview = require("./v20240202preview");
exports.v20240302preview = require("./v20240302preview");
exports.v20240402preview = require("./v20240402preview");
exports.v20240502preview = require("./v20240502preview");
exports.v20240602preview = require("./v20240602preview");
exports.v20240702preview = require("./v20240702preview");
exports.v20240902preview = require("./v20240902preview");
